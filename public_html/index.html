<!DOCTYPE html>
<html>
    <head>
        <title>Connect the Dots</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="text/css" rel="stylesheet" href="css/main_style.css" />
        <script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
        <script type="text/javascript">
            // Ensure entire page is rendered in the browser before JS code is executed
            $(document).ready(function()
            {
                console.log('DOM loaded and ready to be manipulated.');
                
                var canvas = document.getElementById("canvas"); // Get element that has id set to "canvas"
                var ctx = canvas.getContext("2d"); // 2D Graphics context
                fitToContainer(canvas); // call method to adjust canvas to the size of the div container
                                
                canvas.addEventListener("click", placeDot, true); // Add event listener to place dots on canvas whenever a click happens on canvas box
                
                // Array that contains all the unique dots
                var dotSet = [];
                
                // Determine whether submit button is clicked
                document.getElementById('submit').onclick = function()
                {
                    console.log("Number of dot elements: " + dotSet.length);
                    
                    // Iterate set entries with forEach
                    dotSet.forEach(function(value) 
                    {
                        console.log(value);
                    });
                }
                
                /**
                 * Method to place a dot on the {x-coordinate, y-coordinate}, which 
                 * is determined by the location of the click.
                 * @type Arguments
                 */
                function placeDot(e)
                {
                    // Normalize the coordinates relative to the canvas area   
                    var parentPosition = getPosition(e.currentTarget);
    
                    // Get the x-coordinate and y-coordinate of the click
                    var xCoordinate = e.clientX - parentPosition.x; // Get x-coordinate of click
                    var yCoordinate = e.clientY - parentPosition.y; // Get y-coordinate of click
                    console.log("(X, Y) = (" + xCoordinate + ", " + yCoordinate + ")"); 
                    
                    // Draw dot that is 5 pixels wide and 5 pixels high on canvas
                    ctx.fillRect(xCoordinate, yCoordinate , 5, 5);
                    
                    // Add dot object to Set
                    var dotObject = {x: xCoordinate, y: yCoordinate}; // store the x and y coordinates of a dot
                    
                    // Determine if dot object already exists in array
                    var doesDotObjExist = dotSet.some(function(curDotObj)
                    {
                        return curDotObj.x === dotObject.x && curDotObj.y === dotObject.y;
                    });
                    
                    // Only add unique dot object to set
                    if(!doesDotObjExist)
                    {
                        dotSet.push(dotObject);
                    }
                }
                
                /**
                 * This method is used to normalize the x-coordinate and y-coordinate relative to an area
                 * rather than the entire page.
                 * @param {type} element
                 * @returns {undefined}
                 */
                function getPosition(element) 
                {
                    var xPosition = 0;
                    var yPosition = 0;

                    while (element) 
                    {
                        xPosition += (element.offsetLeft - element.scrollLeft + element.clientLeft);
                        yPosition += (element.offsetTop - element.scrollTop + element.clientTop);
                        element = element.offsetParent;
                    }
                    
                    return { x: xPosition, y: yPosition };
                }
        
                /**
                 * Method to adjust the canvas size according to the parent element
                 * @param {type} canvas
                 * @returns {undefined}
                 */
                function fitToContainer(canvas)
                {
                  // Make it visually fill the positioned parent
                  canvas.style.width ='100%';
                  canvas.style.height='100%';
                  
                  // ...then set the internal size to match
                  canvas.width  = canvas.offsetWidth;
                  canvas.height = canvas.offsetHeight;
                }
            });
            
            
        </script>
    </head>
    <body>
        <div id="puzzle" class="dotbox">
            <canvas id="canvas">
            </canvas>
        </div>
        
        <div class="buttonbox">
            <input class="button" type="button" id="submit" value="Solve" />
        </div>
    </body>
</html>
